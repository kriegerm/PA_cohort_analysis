"0","ps_genus <- tax_glom(ps_fs, taxrank = ""Genus"")"
"0",""
"0","# Extract count matrix and convert to matrix"
"0","otu_mat <- as(otu_table(ps_genus), ""matrix"")"
"0",""
"0","# Transpose if samples are rows (optional, depending on orientation)"
"0","if(taxa_are_rows(ps_genus)) {"
"0","  otu_mat <- t(otu_mat)"
"0","}"
"0",""
"0","# Extract Genus names"
"0","taxa_names <- as.data.frame(tax_table(ps_genus))$Genus"
"0",""
"0","# Plot heatmap"
"0","pheatmap(log(otu_mat + .0000001),"
"0","         scale = ""none"",        # keep raw counts"
"0","         clustering_distance_rows = ""euclidean"","
"0","         clustering_distance_cols = ""euclidean"","
"0","         clustering_method = ""complete"","
"0","         fontsize_row = 8,"
"0","         fontsize_col = 8,"
"0","         show_rownames = TRUE,"
"0","         show_colnames = TRUE)"
